/* Chức năng thêm record */

<?php
require "dbConnect.php";

// Truy vấn
$sql = "INSERT INTO tbcve (title, CVE, OSVDB, author, published, impact, platform, file, url) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)";

// Tạo đói tượng prepared
$stmt = $conn->prepare($sql);
// Gán các giá trị vào các tham số ẩn
$stmt->bind_param("sssssssss", $title, $CVE, $OSVDB, $author, $published, $impact, $platform, $file, $url);

// set parameters và thực thi

$title = filter_var($_POST['title'], FILTER_SANITIZE_STRING);	// xử dụng filter để vệ sinh dữ liệu đầu vào
$CVE = filter_var($_POST['cve'], FILTER_SANITIZE_STRING);	// FILTER_SANITIZE_STRING xóa các kí tự <> </>
$OSVDB = filter_var($_POST['osvdb'], FILTER_SANITIZE_STRING);
$author = filter_var($_POST['author'], FILTER_SANITIZE_STRING);
$published = filter_var($_POST['published'], FILTER_SANITIZE_STRING);
$impact = filter_var($_POST['impact'], FILTER_SANITIZE_STRING);
$platform = filter_var($_POST['platform'], FILTER_SANITIZE_STRING);
$file = filter_var($_POST['file'], FILTER_SANITIZE_STRING);
$url = filter_var($_POST['url'], FILTER_SANITIZE_STRING);

if($stmt->execute() === TRUE){
	echo "New record created successfully";
	header("location:index.php");
}else{
	echo "Error: ", $stmt,"<br>", $sql, "<br>", $conn->error;
}
$stmt->close();
$conn->close();
?>

