/* Chức năng export record ra file txt */
<?php
	require "dbConnect.php";
	// Lấy thông tin Record cần export
	$id = $_GET['id'];
	$sql = "SELECT * FROM tbcve WHERE id=?";
	$stmt = $conn->prepare($sql);
	$stmt->bind_param("s", $id);
	$stmt->execute();
	$stmt->bind_result($colId, $colTitle,  $colCve, $colOsvdb, $colAuthor, $colPublished, $colImpact, $colPlatform, $colFile, $colUrl);
	$stmt->store_result();
	$stmt->fetch();

	// Nội dung ghi file
	$expRecord = "ID: ".$colId."\nTitle: ".$colTitle."\nCVE: ".$colCve."\nOSVDB: ".$colOsvdb."\nAuthor: ".$colAuthor."\nPublished: ".$colPublished."\nImpact: ".$colImpact."\nFile: ".$colFile."\nUrl: ".$colUrl; 
	// Tạo file va ghi file : file txt được lưu tại thư mục ./public/export/ với tên là mã CVE
	$expFile = fopen( "./public/export/".$colCve.".txt", "w") or die("Unable to open file!");
	fwrite($expFile, $expRecord);

	$stmt->close();
	$conn->close();
?>
